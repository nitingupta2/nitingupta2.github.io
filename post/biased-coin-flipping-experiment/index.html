<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Nitin Gupta">

  
  
  
    
  
  <meta name="description" content="Recently I listened to a podcast featuring Victor Haghani of Elm Partners, who described a fascinating coin-flipping experiment. The experiment was designed to be played for 30 minutes by participants in groups of 2-15 in university classrooms or office conference rooms, without consulting each other or the internet or other resources. To conduct the experiment, a custom web app was built for placing bets on a simulated coin with a 60% chance of coming up heads.">

  
  <link rel="alternate" hreflang="en-us" href="/post/biased-coin-flipping-experiment/">

  


  
  
  
  <meta name="theme-color" content="hsl(339, 90%, 68%)">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light" disabled>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark">
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.54f0d8ecdd50ac9b1b0821399a5fddc1.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.9a879b7db394c489bc2f88387b1e646d.css">
  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/biased-coin-flipping-experiment/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Nitin Gupta">
  <meta property="og:url" content="/post/biased-coin-flipping-experiment/">
  <meta property="og:title" content="How would you bet? Lessons from a Biased Coin Flipping Experiment | Nitin Gupta">
  <meta property="og:description" content="Recently I listened to a podcast featuring Victor Haghani of Elm Partners, who described a fascinating coin-flipping experiment. The experiment was designed to be played for 30 minutes by participants in groups of 2-15 in university classrooms or office conference rooms, without consulting each other or the internet or other resources. To conduct the experiment, a custom web app was built for placing bets on a simulated coin with a 60% chance of coming up heads."><meta property="og:image" content="/post/biased-coin-flipping-experiment/featured.png">
  <meta property="twitter:image" content="/post/biased-coin-flipping-experiment/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2017-08-03T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2017-08-03T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/biased-coin-flipping-experiment/"
  },
  "headline": "How would you bet? Lessons from a Biased Coin Flipping Experiment",
  
  "image": [
    "/post/biased-coin-flipping-experiment/featured.png"
  ],
  
  "datePublished": "2017-08-03T00:00:00Z",
  "dateModified": "2017-08-03T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Nitin Gupta"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Nitin Gupta",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Recently I listened to a podcast featuring Victor Haghani of Elm Partners, who described a fascinating coin-flipping experiment. The experiment was designed to be played for 30 minutes by participants in groups of 2-15 in university classrooms or office conference rooms, without consulting each other or the internet or other resources. To conduct the experiment, a custom web app was built for placing bets on a simulated coin with a 60% chance of coming up heads."
}
</script>

  

  


  


  





  <title>How would you bet? Lessons from a Biased Coin Flipping Experiment | Nitin Gupta</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="dark">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Nitin Gupta</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#investing"><span>Investing</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Data Science</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#casestudies"><span>Case Studies</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Web Apps</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>How would you bet? Lessons from a Biased Coin Flipping Experiment</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Aug 3, 2017
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    14 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/betting/">betting</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>Recently I listened to a podcast featuring Victor Haghani of <a href="https://elmfunds.com/">Elm Partners</a>, who described a fascinating coin-flipping experiment. The experiment was designed to be played for 30 minutes by participants in groups of 2-15 in university classrooms or office conference rooms, without consulting each other or the internet or other resources. To conduct the experiment, a <a href="http://coinflipbet.herokuapp.com/">custom web app</a> was built for placing bets on a simulated coin with a 60% chance of coming up heads. Participants used their personal laptops or work computers to play. They were offered a stake of <span class="math inline">\(\$25\)</span> to begin, with a promise of a check worth the final balance (subject to a caveat) in their game account. No out-of-pocket betting or any gimmicks. But they had to agree to remain in the room for 30 minutes.</p>
<p>Even though the experiment in no longer active, the <a href="http://coinflipbet.herokuapp.com/">game URL</a> is still active. Before reading any further, I strongly encourage readers to play the game and decide how they would bet and what outcomes they should expect? <strong><em>SPOILERS AHEAD</em></strong></p>
<div id="what-would-be-an-optimal-betting-strategy" class="section level3">
<h3>What would be an optimal betting strategy?</h3>
<p>The details of the experiment are described in a <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2856963">paper</a> that would be very accessible to anyone with a rudimentary understanding of probability.</p>
<p>The probability of heads is reported to be 60%, which means that if the game’s virtual coin is flipped sufficiently large number of times, the number of heads should converge to 60% of the total outcomes. Since each flip is independent of all prior flips, there is a positive expectancy in betting on heads only. The expected gain in betting an amount <span class="math inline">\(x\)</span> on heads is <span class="math inline">\(0.6x - 0.4x = 0.2x\)</span></p>
<p>But how should one bet? Intuitively it is apparent that betting too large would be counter-productive because if we lose, the balance would deplete quickly. A string of consecutive losses would quickly lead to bankruptcy. On the other hand, betting too little isn’t going to be very productive either, even though we know the odds of betting on heads are favorable.</p>
<p>So, somewhere along the spectrum between betting too little or too large, there is an optimal betting strategy. In 1955 John Kelly working at Bell Labs published a formula that showed how to maximize wealth while betting on games with favorable odds. Even though this formula has been known to professional gamblers for decades, to my knowledge, it is not a part of any high school or undergraduate curriculum on probability and statistics. I know this personally, having a background in science and engineering.</p>
<p>When the Kelly formula is applied to a game like this with binary (heads/tails) outcomes, it suggests betting a constant fraction of the existing balance, denoted by <span class="math inline">\(2*p - 1\)</span>, where p is the probability of the favorable outcome. Clearly, the outcome would be favorable only if p &gt; 0.5.</p>
<p>Given that the probability of heads in this game is 0.6, the optimal bet size is <span class="math inline">\(2*0.6-1 = 0.2\)</span> or 20% of the existing balance at each flip. This optimality could be demonstrated by simulation.</p>
<p>In the original experiment, 61 participants flipped virtual coins 7253 times. So during the course of a 30 min game,
a virtual coin was flipped ~ 120 times on average.</p>
<p>I generated a sample set of 1000 games. In each game, a virtual coin is flipped 120 times with a 0.6 probability of getting heads.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/final_balance_distributions-1.png" width="768" /></p>
<p>Assuming there are no constraints in the game and the upside is unbounded, the boxplots show the range of outcomes resulting from a constant percentage bet on heads on each flip.</p>
<p>Few things stand out from this plot:</p>
<ul>
<li><p>Since the lowest balance could only be 0 and the maximum is unbounded, the median provides a better measure of the central tendency of the betting outcomes. The mean is highly skewed by extreme outcomes on the upside. The median provides a balance between those who got extremely lucky and those who weren’t so much. The median balance is the highest while maintaining a constant 20% bet, which is exactly what the Kelly formula suggests.</p></li>
<li><p>If you played the game and didn’t discover the maximum payout, it should be very evident looking at this plot that the game can’t be offered practically without an upper limit. In this sample, the final balance reaches ~ <span class="math inline">\(\$55\)</span> million in a game with 120 flips betting 50% on heads, even though this would be far from an ideal betting strategy. In theory, if someone got extremely lucky they could flip 120 heads in succession and bet 100% each time to get a final balance of <span class="math inline">\(25*1.2^{120} = \$79.4\)</span> billion; although this would be extremely unlikely.</p></li>
<li><p>While betting 40% of the balance, odds are low that you would make more than the starting balance of <span class="math inline">\(\$25\)</span></p></li>
<li><p>While betting 60% or more of the balance, you are almost guaranteed to end up below the starting balance of <span class="math inline">\(\$25\)</span></p></li>
<li><p>While betting 80% or more of the balance, you are almost guaranteed to go bankrupt</p></li>
</ul>
<p>The plots of median final balance and the percentage of games which lead to bankruptcy at each constant proportional bet are shown below, These plots make it clear why the Kelly formula provides the optimal betting strategy. The risk with respect to reward is well-balanced.</p>
<p>The Kelly formula assumes log utility of wealth. With a constant proportional bet of 20% with a 60% chance of heads, the expected utility for each flip is:</p>
<p><span class="math inline">\(0.6*log(1.2) + 0.4*log(0.8) = 0.020136\)</span>, which means that each flip gives a dollar equivalent increase in utility of <span class="math inline">\(exp(0.020136)\)</span> =1.0203401 or ~ 2%</p>
<p>So, 120 flips starting at <span class="math inline">\(\$25\)</span>, leads to <span class="math inline">\(\$25*(1.0203401^{120}) = \$280.1\)</span></p>
<p>Alternatively, in 120 flips, if 60% or 72 were heads, the median outcome could be calculated by <span class="math inline">\(\$25*(1.2^{72})*(0.8^{48}) = \$280.1\)</span></p>
<p>Both of these values correspond to the peak of the median final balance determined from simulation.
The median values for other constant proportional bets could be calculated in the same manner.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/median_plots-1.png" width="768" /></p>
<!-- Furthermore, we can demonstrate that the optimal bet level is only dependent upon the favorability of odds. It is independent of the starting balance and the number of flips. -->
<!-- ```{r Kelly_criterion, cache=TRUE, results='hide'} -->
<!-- dfParam <- crossing(InitialBalance = c(25L, 50L), -->
<!--                     NumFlips = c(20L, 50L, 80L, 120L), -->
<!--                     ProbHeads = c(0.6, 0.65)) -->
<!-- ifileKelly <- "C:/Backups/Website/nitingupta2.github.io/content/post/final_balance_Kelly.rds" -->
<!-- if(file.exists(ifileKelly)) { -->
<!--     dfFinalBalance <- read_rds(ifileKelly) -->
<!-- } else { -->
<!--     dfFinalBalance <- NULL -->
<!--     for(i in 1:nrow(dfParam)) { -->
<!--         cat("\nGetting final profits for param combination: ", i) -->
<!--         initial_balance <- dfParam[["InitialBalance"]][i] -->
<!--         n_flips <- dfParam[["NumFlips"]][i] -->
<!--         p_heads <- dfParam[["ProbHeads"]][i] -->
<!--         set.seed(100) -->
<!--         lCoinFlips <- rerun(n_games, getCoinFlips(n_flips, p_heads)) %>% set_names(paste0("Game_", 1:n_games)) -->
<!--         lBalanceSeries <- map(vBetFraction, .f = ~ getTotalBalanceSeries(lCoinFlips, initial_balance, .x)) %>%  -->
<!--             set_names(paste0("Bet_", vBetFraction*100)) -->
<!--         dfFinalBalance <- map_df(lBalanceSeries, .f = ~ .x[1L+n_flips,]) %>%  -->
<!--             mutate(BetFraction = vBetFraction, -->
<!--                    InitialBalance = initial_balance, -->
<!--                    NumFlips = n_flips, -->
<!--                    ProbHeads = p_heads) %>%  -->
<!--             bind_rows(dfFinalBalance) -->
<!--     } -->
<!--     dfFinalBalance <- dfFinalBalance %>% select(InitialBalance, NumFlips, ProbHeads, BetFraction, everything()) -->
<!--     write_rds(dfFinalBalance, ifileKelly) -->
<!-- } -->
<!-- ``` -->
<!-- ```{r plot_optimal, fig.align='center', fig.width=10} -->
<!-- dfMedianBalanceOpt <- bind_cols(dfFinalBalance %>% select(c(1:4)), -->
<!--                                 MedianBalance = dfFinalBalance %>% select(starts_with("Game")) %>% apply(1, median)) %>%  -->
<!--     mutate(InitialBalanceText = paste0("Starting balance = $", InitialBalance)) %>%  -->
<!--     mutate(ProbHeadsText = paste0("Probability of heads = ", ProbHeads)) -->
<!-- dfAnnText <- dfMedianBalanceOpt %>%  -->
<!--     dplyr::filter(NumFlips == max(NumFlips)) %>%  -->
<!--     group_by(InitialBalance, ProbHeads, NumFlips) %>%  -->
<!--     mutate(OptimalBet = BetFraction,  -->
<!--            MaxBalance = max(MedianBalance)) %>%  -->
<!--     ungroup() %>%  -->
<!--     dplyr::filter(MedianBalance > (MaxBalance - 1e-12)) %>%  -->
<!--     mutate(AnnotateText = paste0("Optimal bet = ",OptimalBet*100, "%")) -->
<!-- ggplot(dfMedianBalanceOpt, aes(x = BetFraction, y = MedianBalance)) +  -->
<!--     geom_line(aes(color = factor(NumFlips)), size = 0.7) + -->
<!--     scale_x_continuous(breaks = seq(0, 1, 0.2), labels = scales::percent) + -->
<!--     scale_y_continuous(label = scales::dollar) + -->
<!--     scale_color_viridis(name = "Number of coin flips", discrete = T, option = "C", direction = -1) + -->
<!--     facet_grid(ProbHeadsText ~ InitialBalanceText, scales = "free") + -->
<!--     geom_text(data = dfAnnText, aes(label = AnnotateText), x=Inf, y=Inf, vjust=1, hjust=1, size = 3.5) + -->
<!--     labs(x = "Constant bet on heads on each flip", -->
<!--          y = "Median final balance") + -->
<!--     theme(strip.text = element_text(face = "bold")) -->
<!-- ``` -->
</div>
<div id="simulating-the-game-play" class="section level3">
<h3>Simulating the game play</h3>
<p>If you’ve read this far, you understand this game can’t be offered without an upper limit on the final payout. If you played the game and bet wisely or were just plain lucky, you would’ve discovered that the maximum payout is <span class="math inline">\(\$250\)</span>. So the objective changes mid-game from growing to preserving existing balance. Once the maximum payout balance is reached, it is foolhardy to keep betting large sums no matter what betting strategy you have chosen.</p>
<p>Secondly, the UI design of the app doesn’t have a mechanism to choose a constant percentage bet level. So, if you were following a systematic betting strategy like Kelly, then you would have to do mental calculations to determine the exact dollar amount. While this is not hard to do, I believe most people would just round up or down to the nearest dollar amount. Also it takes less time to input a whole dollar amount than dollars and cents. So even though the minimum bet size in the game is 1 cent, effectively it would be <span class="math inline">\(\$1\)</span>.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/final_balance_distributions_constrained-1.png" width="768" /></p>
<p>Under these constraints and assumptions, the plot shows bimodal distributions at all bet levels. During the game, the objective changes to maximizing the chances of ending a game above the maximum payout of <span class="math inline">\(\$250\)</span>. Here we can see that the Kelly formula turned out to be a close approximation to optimal, even though the optimal level is determined only in hindsight. Fewer bankruptcies result at higher bet levels than in unconstrained games. I made the assumption that the participants who got lucky early on betting big, decided to bet just <span class="math inline">\(\$1\)</span> on all subsequent bets after discovering the maximum payout.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/maximum_payout_plots-1.png" width="768" /></p>
</div>
<div id="how-did-the-participants-do-in-the-experiment" class="section level3">
<h3>How did the participants do in the experiment?</h3>
<p>Not very well to say the least. There’s an excellent discussion in the paper, but here are the salient points:</p>
<ul>
<li>Only 21% of the participants reached the maximum payout of <span class="math inline">\(\$250\)</span></li>
<li>51% of the participants neither went bust nor reached the maximum payout. Their average final balance was <span class="math inline">\(\$75\)</span></li>
<li>33% of the participants ended up below the starting balance of <span class="math inline">\(\$25\)</span></li>
<li>28% of the participants went bust and received no payout</li>
<li>Average payout across all participants was <span class="math inline">\(\$91\)</span></li>
<li>Only 5 among the 61 participants had heard of the Kelly criterion. Out of those, only 1 managed to barely double his stake while the other broke even after 100 flips</li>
</ul>
</div>
<div id="betting-patterns" class="section level3">
<h3>Betting Patterns</h3>
<p>Betting patterns were found to be quite erratic.</p>
<ul>
<li>18 participants bet all-in on one flip</li>
<li>Some bet too small and then too big</li>
<li>Many participants adopted a <a href="https://en.wikipedia.org/wiki/Martingale_%28betting_system%29">Martingale strategy</a> where the losing bets are doubled up to recover past losses</li>
<li>Some bet small constant wagers to minimize chances of ruin and end up with a positive balance</li>
<li>41 participants (67%!!) bet on tails at some point during the game play. 29 of them bet on tails 5 or more times</li>
</ul>
<p>Despite how terrible some of these betting strategies may have been, hitting the maximum payout limit might have saved some of them from ending up bankrupt. Well, assuming these participants were not foolish enough to keep betting high after knowing they couldn’t get more than <span class="math inline">\(\$250\)</span>.</p>
<p>Let’s see how some of these betting patterns work in simulation.</p>
<div id="all-in-betting" class="section level4">
<h4>All-in Betting</h4>
<p>18 out of 61 participants reportedly bet 100% on a single flip. Assuming they continued this betting pattern, majority of these participants would’ve lost everything after their second bet. Those who reached the maximum payout would’ve had to win first 4 flips in succession. Assuming they kept their wits beyond that point, only 13% of such participants would’ve ended up with a balance of <span class="math inline">\(\$250\)</span> or more.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/all_in_results-1.png" width="672" /></p>
</div>
<div id="betting-too-small-and-then-too-big" class="section level4">
<h4>Betting too small and then too big</h4>
<p>Some participants bet too small and then too big. It appears they were over-cautious at first, but when they built a sizeable balance, they threw caution to the wind. Some form of <a href="https://en.wikipedia.org/wiki/Wealth_effect">wealth effect</a> or <a href="http://www.investopedia.com/terms/h/house-money-effect.asp">house money effect</a> came into play.</p>
<p>To simulate this strategy, I assumed such participants bet 5% until they accumulated a balance of <span class="math inline">\(\$100\)</span>, after which they started betting 30%. If their balance fell below <span class="math inline">\(\$100\)</span> again, they got spooked and adopted the 5% conservative bet again.</p>
<p>The simulated results are quite interesting. Although none of the participants would’ve been bankrupted (assuming they adopted the ultra safe 5% bets when their balance was lower), only ~ 10% of them would’ve made <span class="math inline">\(\$250\)</span> or more.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/small_big_betting_results-1.png" width="672" /></p>
</div>
<div id="martingale-betting" class="section level4">
<h4>Martingale betting</h4>
<p><a href="https://en.wikipedia.org/wiki/Martingale_%28betting_system%29">Martingale</a> bettors keep doubling up their bets after every loss. For instance, if they bet <span class="math inline">\(\$2\)</span> and lost, their next bet would be <span class="math inline">\(\$4\)</span>, and the next one <span class="math inline">\(\$8\)</span> if they lost again. Their idea is to recover the former loss(es) and make profits equal to the original stake. Most often this strategy starts with betting small and doubles up on the previous bet even in successive losses. This idea mostly stems from <a href="https://en.wikipedia.org/wiki/Gambler%27s_fallacy">gambler’s fallacy</a>. So if a Martingale bettor was betting on heads but the coin flipped tails several times in succession, their belief is the next flip would be heads and they’ll recover everything they’ve lost thus far. After all mean reversion should come into play, right?.</p>
<p>But mean reversion could take much longer to manifest. The coin has no memory of the past flips. Every flip is independent of the prior flips. Even with a biased coin like in this game, it could very well happen that it flips tails 20 times in succession and then flips heads 30 times in succession. The probability of heads converges to 0.6 only <strong><em>in the long run</em></strong>. After losing 20 bets in succession starting with <span class="math inline">\(\$1\)</span>,
a Martingale bettor would need to bet ~ $1.05 million to recover past losses.</p>
<p>To simulate this betting strategy, I assumed a minimum bet size of <span class="math inline">\(\$1\)</span> as long as the balance is <span class="math inline">\(\$25\)</span> or lower i.e. 4% to start. The minimum bet is readjusted proportionally as the balance increases or decreases in multiples of
<span class="math inline">\(\$25\)</span>. So it goes up to <span class="math inline">\(\$2\)</span> when the balance is above <span class="math inline">\(\$50\)</span> and <span class="math inline">\(\$4\)</span> when the balance is above <span class="math inline">\(\$100\)</span>. The previous losing bet is doubled up in succession.</p>
<p>The simulated results show 42% of the bettors going bankrupt with this strategy.
Only 38% of the bettors would’ve ended up with <span class="math inline">\(\$250\)</span> or more.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/martingale_results-1.png" width="672" /></p>
</div>
<div id="betting-on-tails" class="section level4">
<h4>Betting on tails</h4>
<p>There were 41 participants who bet on tails at some point during the game. 29 of them bet on tails more than 5 times in the game. 13 of them bet on tails more than 25% of the time. These participants were more likely to make that bet after a string of consecutive heads. As the authors state in the paper <em>“…some combination of the illusion of control, law of small number bias, gambler’s fallacy or hot hand fallacy was at work”</em>.</p>
<p>Let’s assume, these participants bet on heads, until a string of ‘X’ heads, after which they kept betting on tails until they got one, after which they bet on heads again repeating the same process. What would be the value of ‘X’ for the participants to bet on tails more than 25% of the time?
We could get a sense from the simulated game data.</p>
<pre><code>Heads_Threshold_2 Heads_Threshold_3 Heads_Threshold_4 Heads_Threshold_5 Heads_Threshold_6 
             0.35              0.21              0.12              0.07              0.04 </code></pre>
<p>It turns out most of these participants were expecting tails after a string of 3 or more heads. Assuming they followed this heuristic, even while making the optimal 20% bet, the simulated results show ~ 7% of the participants going bankrupt and only 25% of them ending up with <span class="math inline">\(\$250\)</span>.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/betting_tails_results-1.png" width="672" /></p>
</div>
</div>
<div id="comparison-of-betting-strategies" class="section level3">
<h3>Comparison of Betting Strategies</h3>
<p>The plot below shows the performance of the betting strategies modelled above, with respect to a game optimal strategy of betting 20% of the balance. Most of them end up with a much higher proportion of participants going bankrupt in the game. No strategy comes anywhere close to the game optimal strategy, when it comes to the number of participants reaching the maximum payout offered in the game.</p>
<p>In fact, discovering the maximum payout of <span class="math inline">\(\$250\)</span> would’ve helped some of the participants employing these wayward betting strategies into adopting more conservative approaches in the latter part of their game. But if the game was designed to payout a fraction of the final balance, some more interesting outcomes might emerge. For instance, the maximum balance in the game could be raised to 2500 and the actual payout could be a tenth of that
(<span class="math inline">\(\$250\)</span> still). The evidence from simulated results suggests the outcomes in that case to be much worse.</p>
<p><img src="/post/biased-coin-flipping-experiment/index_files/figure-html/betting_comparison-1.png" width="672" /></p>
</div>
<div id="how-did-i-play-the-game" class="section level3">
<h3>How did I play the game?</h3>
<p>To be sure, I was <em>not</em> a part of the cohort of 61 participants who played this game in person and were paid for participation. The <a href="http://coinflipbet.herokuapp.com/">game URL</a> is still active, even though there’s no actual payout offered any more. I found it after listening to the <a href="https://chatwithtraders.com/ep-129-victor-haghani/">podcast</a> and reading the <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2856963">paper</a>. So, unfortunately I already knew the optimal strategy before trying. In my gameplay, I reached the maximum payout by the 16th minute. I ended up with a balance of <span class="math inline">\(\$270\)</span>, flipping the virtual coin a total of 122 times.</p>
<p>I did however, get some loved ones to play the game uninformed and then tell me their betting strategies. In a sample of n = 4, they reported everything from Martingale betting, betting 10 cents per flip, finding patterns in flip sequences and even betting on tails because of said patterns. In other words, I got a microcosm of results in the paper.</p>
<p>I would have bet erratically myself, had I not known the optimal strategy. A smaller proportion than optimal at first and then perhaps too big.</p>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>Despite being offered favorable odds, most participants adopted strategies subject to their own biases and ended up with poor to suboptimal outcomes. Having a background in quantitative fields didn’t seem to help most of them. Through simulations we can explore outcomes of some of these biases, but actual gameplay involves much more complexity. Most participants would’ve been swayed by a combination of biases at different points during their gameplay.</p>
<p>Even though betting a constant proportion is an optimal strategy for this game, and has been known since 1955, there persists a gap in education where even the most quantitatively oriented people like myself have no idea about it. Experiments like this have tremendous educational value and should be part of the curriculum in both high schools and colleges. I firmly agree with the thoughts echoed in the paper.</p>
<p>In a broader context, this experiment shares similarities with investing. Often the same biases come into play while investing. Even though the outcomes in investing are continuous in nature, and uncertainities abound, a systematic strategy could spell the difference between attaining financial objectives or not. It shows the importance and benefits of sticking to a well-thought-out systematic plan that is devoid of all biases.</p>
<hr />
<p><em>The R markdown file for this post is available <a href="https://github.com/nitingupta2/nitingupta2.github.io/blob/master/post/biased-coin-flipping-experiment/">here</a></em>.</p>
</div>

    </div>

    



<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/rstats/">rstats</a>
  
  <a class="badge badge-light" href="/tags/simulations/">simulations</a>
  
</div>














  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Nitin Gupta</a></h5>
      <h6 class="card-subtitle">Founder</h6>
      <p class="card-text">Quantitative Data Technologies</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.github.com/nitingupta2" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/nitingupta2" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/text-analysis-of-amazon-shareholder-letters/">Text Analysis of Amazon Shareholder Letters</a></li>
      
      <li><a href="/post/building-a-predictive-typing-model/">Building a Predictive Typing Model</a></li>
      
      <li><a href="/post/best-batsmen-in-cricket-at-present/">Best batsmen in cricket at present</a></li>
      
      <li><a href="/post/top-batsmen-in-cricket/">Top batsmen in cricket</a></li>
      
      <li><a href="/post/a-brief-history-of-cricket/">A brief history of cricket</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    &copy; Nitin Gupta. All Rights Reserved. &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
